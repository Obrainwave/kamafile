import{r as o,j as e}from"./react-vendor-C7OGPxf-.js";import{a as c}from"./adminAPI-DETaF7HS.js";import{v as T,B as C,a as U,d as y,i as w,u as q,_ as H,au as J,a9 as K,av as M,aw as N,ax as B,ay as s,az as G,m as W,I as m,aK as Q,aL as V,t as X,aC as Y,aD as Z,D as $,aE as ee,b as te,k as p,a2 as ae,aI as re,aJ as ie}from"./mui-vendor-Cgz2Gown.js";import"./vendor-C6eT50bt.js";import"./api-DFHi_IMI.js";import"./utils-vendor-B9ygI19o.js";function he(){const[l,z]=o.useState([]),[E,_]=o.useState(!0),[b,d]=o.useState(null),[F,D]=o.useState(!1),[u,f]=o.useState(null),[a,n]=o.useState({title:"",description:"",image_url:"",order:0,is_active:!0});o.useEffect(()=>{x()},[]);const x=async()=>{var t,r;try{_(!0),d(null);const i=await c.getBanners();z(i)}catch(i){d(((r=(t=i.response)==null?void 0:t.data)==null?void 0:r.detail)||"Failed to load banners")}finally{_(!1)}},S=t=>{t?(f(t),n({title:t.title,description:t.description||"",image_url:t.image_url||"",order:t.order,is_active:t.is_active})):(f(null),n({title:"",description:"",image_url:"",order:l.length,is_active:!0})),D(!0)},v=()=>{D(!1),f(null),n({title:"",description:"",image_url:"",order:0,is_active:!0})},O=async()=>{var t,r;try{u?await c.updateBanner(u.id,a):await c.createBanner(a),v(),x()}catch(i){d(((r=(t=i.response)==null?void 0:t.data)==null?void 0:r.detail)||"Failed to save banner")}},L=async t=>{var r,i;if(window.confirm("Are you sure you want to delete this banner?"))try{await c.deleteBanner(t),x()}catch(j){d(((i=(r=j.response)==null?void 0:r.data)==null?void 0:i.detail)||"Failed to delete banner")}},A=async(t,r)=>{var I,k;const i=l.find(h=>h.id===t);if(!i)return;const j=l.findIndex(h=>h.id===t),g=r==="up"?j-1:j+1;if(g<0||g>=l.length)return;const R=l[g].order,P=i.order;try{await c.updateBanner(t,{order:R}),await c.updateBanner(l[g].id,{order:P}),x()}catch(h){d(((k=(I=h.response)==null?void 0:I.data)==null?void 0:k.detail)||"Failed to update order")}};return E?e.jsx(T,{maxWidth:"xl",children:e.jsx(C,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(U,{})})}):e.jsxs(T,{maxWidth:"xl",children:[e.jsxs(C,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(y,{variant:"h4",component:"h1",fontWeight:"bold",children:"Banner Management"}),e.jsx(w,{variant:"contained",startIcon:e.jsx(q,{}),onClick:()=>S(),children:"Add Banner"})]}),b&&e.jsx(H,{severity:"error",sx:{mb:2},onClose:()=>d(null),children:b}),e.jsx(J,{component:K,children:e.jsxs(M,{children:[e.jsx(N,{children:e.jsxs(B,{children:[e.jsx(s,{children:"Order"}),e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Image"}),e.jsx(s,{children:"Status"}),e.jsx(s,{align:"right",children:"Actions"})]})}),e.jsxs(G,{children:[l.map((t,r)=>e.jsxs(B,{hover:!0,children:[e.jsx(s,{children:e.jsxs(W,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(m,{size:"small",onClick:()=>A(t.id,"up"),disabled:r===0,children:e.jsx(Q,{fontSize:"small"})}),e.jsx(y,{variant:"body2",children:t.order}),e.jsx(m,{size:"small",onClick:()=>A(t.id,"down"),disabled:r===l.length-1,children:e.jsx(V,{fontSize:"small"})})]})}),e.jsx(s,{children:t.title}),e.jsx(s,{children:t.image_url?e.jsx(C,{component:"img",src:t.image_url,alt:t.title,sx:{width:60,height:40,objectFit:"cover",borderRadius:1}}):"-"}),e.jsx(s,{children:e.jsx(X,{label:t.is_active?"Active":"Inactive",color:t.is_active?"success":"default",size:"small"})}),e.jsxs(s,{align:"right",children:[e.jsx(m,{size:"small",onClick:()=>S(t),color:"primary",children:e.jsx(Y,{})}),e.jsx(m,{size:"small",onClick:()=>L(t.id),color:"error",children:e.jsx(Z,{})})]})]},t.id)),l.length===0&&e.jsx(B,{children:e.jsx(s,{colSpan:5,align:"center",children:e.jsx(y,{variant:"body2",color:"text.secondary",sx:{py:4},children:"No banners found. Create your first banner to get started."})})})]})]})}),e.jsxs($,{open:F,onClose:v,maxWidth:"md",fullWidth:!0,children:[e.jsx(ee,{children:u?"Edit Banner":"Create Banner"}),e.jsx(te,{children:e.jsxs(W,{spacing:3,sx:{mt:1},children:[e.jsx(p,{label:"Title",fullWidth:!0,required:!0,value:a.title,onChange:t=>n({...a,title:t.target.value})}),e.jsx(p,{label:"Description",fullWidth:!0,multiline:!0,rows:4,value:a.description,onChange:t=>n({...a,description:t.target.value})}),e.jsx(p,{label:"Image URL",fullWidth:!0,value:a.image_url,onChange:t=>n({...a,image_url:t.target.value}),placeholder:"https://example.com/image.jpg"}),e.jsx(p,{label:"Order",type:"number",fullWidth:!0,value:a.order,onChange:t=>n({...a,order:parseInt(t.target.value)||0})}),e.jsx(ae,{control:e.jsx(re,{checked:a.is_active,onChange:t=>n({...a,is_active:t.target.checked})}),label:"Active"})]})}),e.jsxs(ie,{children:[e.jsx(w,{onClick:v,children:"Cancel"}),e.jsx(w,{onClick:O,variant:"contained",disabled:!a.title,children:u?"Update":"Create"})]})]})]})}export{he as default};
