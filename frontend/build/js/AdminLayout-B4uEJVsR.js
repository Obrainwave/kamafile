import{r as o,u as I,i as L,j as t,O as S}from"./react-vendor-CJSarQ9f.js";import{a as w}from"./api-DT-DgYzl.js";import{B as l,a as k,C as T,af as B,ag as A,d as g,I as D,g as M,ai as z,aj as v,A as U,aa as C,ah as W,am as E,L as O,q as P,an as G,r as R,s as _,ak as H,a7 as $,as as q,n as N,S as F,at as J}from"./mui-vendor-CUsFfAzq.js";import"./vendor-Bo3UNITv.js";import"./utils-vendor-D5lHaTRS.js";function K(){const[e,i]=o.useState(null),[x,h]=o.useState(!0),[a,c]=o.useState(!1),r=I();o.useEffect(()=>{m()},[]);const m=async()=>{try{const s=await w.getCurrentUser();i(s);const p=["admin","super_admin","moderator","support"];s.role&&p.includes(s.role)?c(!0):r("/")}catch{r("/signin")}finally{h(!1)}};return{user:e,loading:x,isAdmin:a}}const d=240,Q=[{text:"Dashboard",icon:t.jsx(H,{}),path:"/admin"},{text:"Users",icon:t.jsx($,{}),path:"/admin/users"},{text:"Analytics",icon:t.jsx(q,{}),path:"/admin/analytics"},{text:"Content",icon:t.jsx(N,{}),path:"/admin/content"},{text:"RAG Management",icon:t.jsx(F,{}),path:"/admin/rag"},{text:"Settings",icon:t.jsx(J,{}),path:"/admin/settings"}];function at(){var j,y,f,b;const e=I(),i=L(),{loading:x,isAdmin:h,user:a}=K(),[c,r]=o.useState(null),m=n=>{r(n.currentTarget)},s=()=>{r(null)},p=async()=>{try{await w.logout(),e("/signin")}catch{}s()};return x?t.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:t.jsx(k,{})}):h?t.jsxs(l,{sx:{display:"flex",minHeight:"100vh"},children:[t.jsx(T,{}),t.jsx(B,{position:"fixed",sx:{width:{sm:`calc(100% - ${d}px)`},ml:{sm:`${d}px`},zIndex:n=>n.zIndex.drawer+1,bgcolor:"background.paper",color:"text.primary",boxShadow:1},children:t.jsxs(A,{sx:{justifyContent:"space-between"},children:[t.jsx(g,{variant:"h6",noWrap:!0,component:"div",fontWeight:"bold",children:"Admin Dashboard"}),t.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[t.jsx(g,{variant:"body2",sx:{display:{xs:"none",sm:"block"}},children:(a==null?void 0:a.full_name)||(a==null?void 0:a.email)}),t.jsx(D,{size:"large",edge:"end",onClick:m,color:"inherit",children:t.jsx(M,{sx:{width:32,height:32,bgcolor:"secondary.main"},children:((y=(j=a==null?void 0:a.full_name)==null?void 0:j[0])==null?void 0:y.toUpperCase())||((b=(f=a==null?void 0:a.email)==null?void 0:f[0])==null?void 0:b.toUpperCase())||"A"})}),t.jsxs(z,{anchorEl:c,open:!!c,onClose:s,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[t.jsxs(v,{onClick:()=>{e("/"),s()},children:[t.jsx(U,{sx:{mr:1}}),"Go to Site"]}),t.jsx(C,{}),t.jsxs(v,{onClick:p,children:[t.jsx(W,{sx:{mr:1}}),"Logout"]})]})]})]})}),t.jsxs(E,{variant:"permanent",sx:{width:d,flexShrink:0,"& .MuiDrawer-paper":{width:d,boxSizing:"border-box",bgcolor:"primary.dark",color:"primary.contrastText"}},children:[t.jsx(A,{children:t.jsx(g,{variant:"h6",noWrap:!0,component:"div",fontWeight:"bold",color:"inherit",children:"Admin Panel"})}),t.jsx(C,{sx:{bgcolor:"rgba(255, 255, 255, 0.12)"}}),t.jsx(O,{children:Q.map(n=>{const u=i.pathname===n.path||n.path!=="/admin"&&i.pathname.startsWith(n.path);return t.jsx(P,{disablePadding:!0,children:t.jsxs(G,{onClick:()=>e(n.path),selected:u,sx:{color:"primary.contrastText","&:hover":{bgcolor:"rgba(255, 255, 255, 0.08)"},"&.Mui-selected":{bgcolor:"primary.main",color:"primary.contrastText","&:hover":{bgcolor:"primary.main"}}},children:[t.jsx(R,{sx:{color:"primary.contrastText",opacity:u?1:.7},children:n.icon}),t.jsx(_,{primary:n.text})]})},n.text)})})]}),t.jsx(l,{component:"main",sx:{flexGrow:1,p:3,mt:8},children:t.jsx(S,{})})]}):null}export{at as default};
