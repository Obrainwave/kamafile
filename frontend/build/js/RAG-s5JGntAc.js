import{r as o,j as e,S as N}from"./index-CtZe0orJ.js";import{a as y}from"./adminAPI-pCiTY4we.js";import{C as oe,a as de}from"./Container-B1p7Csts.js";import{A as S,C as Me}from"./Alert-DEvzc-ke.js";import{B as u}from"./Button-DSgQr6FG.js";import{M as $}from"./Modal-Cbb77CXp.js";import{I as q}from"./Input-DCDiL-_I.js";import{c as m}from"./createLucideIcon-BzLNr2Zq.js";import{F as Ue}from"./file-text-BdylwFzr.js";import{T as Le}from"./trash-2-DkoVXXkn.js";import{C as ze}from"./circle-check-big-BXrFS2Xy.js";import"./api-sa1Artjr.js";import"./x-kfxjC3rr.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$e=m("check",Se);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Oe=m("copy",qe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Be=m("database",Pe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ee=m("external-link",Ve);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Ie=m("globe",Ge);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],He=m("link",We);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],O=m("loader",Xe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],P=m("refresh-cw",Ke);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],pe=m("upload",Qe);function dt(){var X,K,Q,J,Y,Z,ee,te;const[U,xe]=o.useState([]),[ue,B]=o.useState(!0),[k,d]=o.useState(null),[r,V]=o.useState(null),[C,E]=o.useState(!1),[me,D]=o.useState(!1),[he,R]=o.useState(!1),[T,A]=o.useState(!1),[c,j]=o.useState({title:"",file:null}),[x,b]=o.useState({title:"",url:""}),[ge,v]=o.useState(!1),[fe,F]=o.useState(null),[ye,M]=o.useState(!1),[L,G]=o.useState(!1),[h,w]=o.useState({}),g=o.useRef(null);o.useEffect(()=>{f(),I();const t=setInterval(()=>{f(),I()},5e3);return()=>clearInterval(t)},[]);const I=async()=>{var t,s,l,n,i,p,_,se,ae,le;try{E(!0);const a=await y.getVectorStoreInfo(),Fe={qdrant_host:(a==null?void 0:a.qdrant_host)||"localhost",qdrant_port:(a==null?void 0:a.qdrant_port)||6333,web_ui_url:(a==null?void 0:a.web_ui_url)||"http://localhost:6333/dashboard",collection_info:{name:((t=a==null?void 0:a.collection_info)==null?void 0:t.name)||"tax_legal_documents",points_count:typeof((s=a==null?void 0:a.collection_info)==null?void 0:s.points_count)=="number"?a.collection_info.points_count:typeof((l=a==null?void 0:a.collection_info)==null?void 0:l.vectors_count)=="number"?a.collection_info.vectors_count:0,vectors_count:typeof((n=a==null?void 0:a.collection_info)==null?void 0:n.vectors_count)=="number"?a.collection_info.vectors_count:typeof((i=a==null?void 0:a.collection_info)==null?void 0:i.points_count)=="number"?a.collection_info.points_count:0,indexed_vectors_count:(()=>{var ne,ie,ce;const z=typeof((ne=a==null?void 0:a.collection_info)==null?void 0:ne.points_count)=="number"?a.collection_info.points_count:typeof((ie=a==null?void 0:a.collection_info)==null?void 0:ie.vectors_count)=="number"?a.collection_info.vectors_count:0,re=typeof((ce=a==null?void 0:a.collection_info)==null?void 0:ce.indexed_vectors_count)=="number"?a.collection_info.indexed_vectors_count:null;return re===0&&z>0?z:re??z})(),status:((p=a==null?void 0:a.collection_info)==null?void 0:p.status)||"unknown",config:{vector_size:typeof((se=(_=a==null?void 0:a.collection_info)==null?void 0:_.config)==null?void 0:se.vector_size)=="number"?a.collection_info.config.vector_size:384,distance:((le=(ae=a==null?void 0:a.collection_info)==null?void 0:ae.config)==null?void 0:le.distance)||"Cosine"}}};V(Fe)}catch{V({qdrant_host:"localhost",qdrant_port:6333,web_ui_url:"http://localhost:6333/dashboard",collection_info:{name:"tax_legal_documents",points_count:0,vectors_count:0,indexed_vectors_count:0,status:"error",config:{vector_size:384,distance:"Cosine"}}})}finally{E(!1)}},f=async()=>{var t,s;try{B(!0),d(null);const l=await y.getRAGDocuments();xe(l)}catch(l){d(((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.detail)||"Failed to load RAG documents")}finally{B(!1)}},W=t=>{if(!t)return"";let s=t.replace(/\.[^/.]+$/,"");return s=s.replace(/[-_]/g," "),s=s.replace(/\s+base\s*$/i,""),s=s.replace(/\s+copy\s*$/i,""),s=s.replace(/\s+\(\d+\)\s*$/,""),s=s.replace(/\b(19|20)\d{2}\b/g,""),s=s.replace(/\s+/g," ").trim(),s.split(" ").map(i=>i===i.toUpperCase()&&i.length>=2&&i.length<=4?i:i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()).join(" ")||t.replace(/\.[^/.]+$/,"")},je=t=>{var l,n;const s=(l=t.target.files)==null?void 0:l[0];if(s){const i=W(s.name),p=c.title,_=!p||p===((n=c.file)==null?void 0:n.name)?i:p;j({...c,file:s,title:_})}},ve=t=>{t.preventDefault(),t.stopPropagation(),v(!0)},_e=t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget.contains(t.relatedTarget)||v(!1)},be=t=>{var l;t.preventDefault(),t.stopPropagation(),v(!1);const s=t.dataTransfer.files;if(s&&s.length>0){const n=s[0],i=W(n.name),p=c.title,_=!p||p===((l=c.file)==null?void 0:l.name)?i:p;j({...c,file:n,title:_})}},we=async()=>{var t,s,l,n;if(!c.file||!c.title){d("Please select a file and provide a title");return}try{A(!0),d(null),await y.uploadRAGFile(c.file,c.title),D(!1),j({title:"",file:null}),v(!1),g.current&&(g.current.value=""),f()}catch(i){const p=((s=(t=i.response)==null?void 0:t.data)==null?void 0:s.detail)||((n=(l=i.response)==null?void 0:l.data)==null?void 0:n.message)||i.message||"Failed to upload file";d(`Upload failed: ${p}`)}finally{A(!1)}},Ne=async()=>{var t,s;if(!x.url||!x.title){d("Please provide both URL and title");return}try{A(!0),d(null),await y.addRAGUrl({title:x.title,url:x.url}),R(!1),b({title:"",url:""}),f()}catch(l){d(((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.detail)||"Failed to add URL")}finally{A(!1)}},ke=async t=>{var s,l;if(window.confirm("Are you sure you want to delete this document?"))try{await y.deleteRAGDocument(t),f()}catch(n){d(((l=(s=n.response)==null?void 0:s.data)==null?void 0:l.detail)||"Failed to delete document")}},Ce=async t=>{var s,l;try{await y.reprocessRAGDocument(t),f()}catch(n){d(((l=(s=n.response)==null?void 0:s.data)==null?void 0:l.detail)||"Failed to reprocess document")}},De=async()=>{var t,s;if(window.confirm(`This will reprocess ${h.status?`all ${h.status} `:"all "}documents. Old chunks will be deleted and documents will be re-indexed with updated metadata (law names, etc.). This may take several minutes. Continue?`))try{G(!0),d(null);const l=await y.bulkReprocessRAGDocuments(h.status,h.sourceType),n=`${l.message}. `+(l.errors.length>0?`Errors: ${l.errors.length}`:"All documents queued successfully.");alert(n),M(!1),w({}),f()}catch(l){d(((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.detail)||"Failed to bulk reprocess documents")}finally{G(!1)}},Re=async(t,s)=>{try{await navigator.clipboard.writeText(t),F(s),setTimeout(()=>{F(null)},2e3)}catch{const n=document.createElement("textarea");n.value=t,n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.select();try{document.execCommand("copy"),F(s),setTimeout(()=>{F(null)},2e3)}catch{}document.body.removeChild(n)}},Te=t=>{switch(t){case"completed":return e.jsx(ze,{className:"w-5 h-5 text-green-600"});case"failed":return e.jsx(Me,{className:"w-5 h-5 text-red-600"});case"processing":return e.jsx(O,{className:"w-5 h-5 text-blue-600 animate-spin"});default:return e.jsx(O,{className:"w-5 h-5 text-gray-400"})}},Ae=t=>{switch(t){case"completed":return"Completed";case"failed":return"Failed";case"processing":return"Processing";default:return"Pending"}},H=t=>t?t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(2)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`:"-";return ue&&U.length===0?e.jsx(oe,{maxWidth:"xl",children:e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(N,{size:"lg"})})}):e.jsxs(oe,{maxWidth:"xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold truncate",children:"RAG Management"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage documents and URLs for the knowledge base"})]}),e.jsxs("div",{className:"flex gap-3 flex-shrink-0 flex-wrap",children:[e.jsxs(u,{variant:"outline",onClick:()=>M(!0),className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(P,{className:"w-4 h-4"}),"Bulk Reprocess"]}),e.jsxs(u,{variant:"outline",onClick:()=>R(!0),className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(He,{className:"w-4 h-4"}),"Add URL"]}),e.jsxs(u,{variant:"primary",onClick:()=>D(!0),className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(pe,{className:"w-4 h-4"}),"Upload File"]})]})]}),k&&e.jsx(S,{severity:"error",className:"mb-4",onClose:()=>d(null),children:k}),e.jsxs(de,{className:"mb-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Be,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Vector Database Statistics"})]}),(r==null?void 0:r.web_ui_url)&&e.jsxs("a",{href:r.web_ui_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-primary hover:underline",children:[e.jsx(Ee,{className:"w-4 h-4"}),"Open Qdrant Web UI"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Chunks"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C?e.jsx(N,{size:"sm"}):String(((X=r==null?void 0:r.collection_info)==null?void 0:X.points_count)??((K=r==null?void 0:r.collection_info)==null?void 0:K.vectors_count)??0)})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Indexed Vectors"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C?e.jsx(N,{size:"sm"}):String(((Q=r==null?void 0:r.collection_info)==null?void 0:Q.indexed_vectors_count)??0)})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Vector Size"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C?e.jsx(N,{size:"sm"}):(Y=(J=r==null?void 0:r.collection_info)==null?void 0:J.config)!=null&&Y.vector_size?`${r.collection_info.config.vector_size}D`:"384D"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Distance Metric"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C?e.jsx(N,{size:"sm"}):(ee=(Z=r==null?void 0:r.collection_info)==null?void 0:Z.config)!=null&&ee.distance?r.collection_info.config.distance:"Cosine"})]})]}),((te=r==null?void 0:r.collection_info)==null?void 0:te.name)&&e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsx("strong",{children:"Collection:"})," ",r.collection_info.name," â€¢"," ",e.jsx("strong",{children:"Host:"})," ",r.qdrant_host,":",r.qdrant_port]})]}),e.jsx(de,{className:"overflow-hidden w-full",children:e.jsx("div",{className:"overflow-x-auto w-full",style:{minWidth:0},children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Type"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Size"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Chunks"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Created"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[U.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 sm:px-6 py-4 min-w-0 max-w-xs",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.source_type==="url"?e.jsx(Ie,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}):e.jsx(Ue,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:t.title})]})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-700",children:t.source_type})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 min-w-0 max-w-xs",children:e.jsx("div",{className:"text-sm text-gray-600 truncate",title:t.source_path||t.file_name||"",children:t.source_type==="url"?e.jsx("a",{href:t.source_path||"",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate block",children:t.source_path}):e.jsx("span",{className:"truncate",children:t.file_name||t.source_path||"-"})})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:H(t.file_size)}),e.jsxs("td",{className:"w-100 px-4 sm:px-6 py-4 min-w-0 max-w-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Te(t.processing_status),e.jsx("span",{className:"text-sm text-gray-700",children:Ae(t.processing_status)})]}),t.processing_error&&e.jsxs("div",{className:"flex items-center gap-1 mt-1 group",children:[e.jsxs("div",{className:"text-xs text-red-600 truncate max-w-[100px] flex-1",title:t.processing_error,children:[t.processing_error.substring(0,40),"..."]}),e.jsx("button",{onClick:l=>{l.stopPropagation(),Re(t.processing_error||"",t.id)},className:"flex-shrink-0 p-1 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition opacity-0 group-hover:opacity-100",title:"Copy full error message",children:fe===t.id?e.jsx($e,{className:"w-4 h-4 text-green-600"}):e.jsx(Oe,{className:"w-4 h-4"})})]})]}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.processing_status==="completed"&&((s=t.content_metadata)!=null&&s.chunks_count)?e.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded bg-green-100 text-green-700",children:[t.content_metadata.chunks_count," ",t.content_metadata.chunks_count===1?"chunk":"chunks"]}):t.processing_status==="completed"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded bg-gray-100 text-gray-600",children:"0 chunks"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[t.processing_status==="failed"&&e.jsx("button",{onClick:()=>Ce(t.id),className:"p-1 text-blue-600 hover:text-blue-700 flex-shrink-0",title:"Reprocess",children:e.jsx(P,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>ke(t.id),className:"p-1 text-red-600 hover:text-red-700 flex-shrink-0",title:"Delete",children:e.jsx(Le,{className:"w-5 h-5"})})]})})]},t.id)}),U.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"No documents found. Upload a file or add a URL to get started."})})]})]})})}),e.jsx($,{open:me,onClose:()=>{D(!1),j({title:"",file:null}),v(!1),g.current&&(g.current.value="")},title:"Upload RAG Document",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(q,{label:"Title (Law Name)",required:!0,value:c.title,onChange:t=>j({...c,title:t.target.value}),placeholder:"e.g., Personal Income Tax Act, VAT Act 2023",helperText:"Enter the proper law name (e.g., 'Personal Income Tax Act', not the filename). The filename will be used as a fallback if not specified."}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["File ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:`mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-lg transition cursor-pointer ${ge?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:ve,onDragLeave:_e,onDrop:be,onClick:t=>{var s;t.preventDefault(),t.stopPropagation(),(s=g.current)==null||s.click()},onMouseDown:t=>t.stopPropagation(),children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(pe,{className:"mx-auto h-12 w-12 text-gray-400 pointer-events-none"}),e.jsxs("div",{className:"flex text-sm text-gray-600 justify-center",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary-dark focus-within:outline-none",onClick:t=>{t.stopPropagation(),t.preventDefault()},children:[e.jsx("span",{children:"Upload a file"}),e.jsx("input",{id:"file-upload",ref:g,name:"file-upload",type:"file",className:"sr-only",onChange:je,accept:"*/*",onClick:t=>t.stopPropagation()})]}),e.jsx("p",{className:"pl-1 pointer-events-none",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500 pointer-events-none",children:"All file types supported (PDF, DOCX, images, etc.)"}),c.file&&e.jsxs("p",{className:"text-sm text-gray-700 mt-2 pointer-events-none",children:["Selected: ",e.jsx("span",{className:"font-medium",children:c.file.name})," (",H(c.file.size),")"]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(u,{variant:"outline",onClick:()=>{D(!1),j({title:"",file:null}),v(!1),g.current&&(g.current.value="")},children:"Cancel"}),e.jsx(u,{variant:"primary",onClick:we,disabled:!c.file||!c.title||T,children:T?"Uploading...":"Upload"})]})]})}),e.jsx($,{open:he,onClose:()=>{R(!1),b({title:"",url:""})},title:"Add URL to RAG",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(q,{label:"Title",required:!0,value:x.title,onChange:t=>b({...x,title:t.target.value}),placeholder:"Enter document title"}),e.jsx(q,{label:"URL",required:!0,type:"url",value:x.url,onChange:t=>b({...x,url:t.target.value}),placeholder:"https://example.com/page"}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(u,{variant:"outline",onClick:()=>{R(!1),b({title:"",url:""})},children:"Cancel"}),e.jsx(u,{variant:"primary",onClick:Ne,disabled:!x.url||!x.title||T,children:T?"Adding...":"Add URL"})]})]})}),e.jsxs($,{open:ye,onClose:()=>{M(!1),w({})},title:"Bulk Reprocess Documents",size:"md",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{severity:"warning",children:"This will reprocess selected documents to update their metadata (law names, etc.) with the new extraction logic. Old chunks will be deleted and documents will be re-indexed. This may take several minutes."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Status (Optional)"}),e.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition",value:h.status||"",onChange:t=>w({...h,status:t.target.value||void 0}),children:[e.jsx("option",{value:"",children:"All statuses"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Only reprocess documents with the selected status. Leave empty to reprocess all."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Source Type (Optional)"}),e.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition",value:h.sourceType||"",onChange:t=>w({...h,sourceType:t.target.value||void 0}),children:[e.jsx("option",{value:"",children:"All types"}),e.jsx("option",{value:"file",children:"File uploads"}),e.jsx("option",{value:"url",children:"URLs"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Only reprocess documents of the selected type. Leave empty to reprocess all."})]})]}),k&&e.jsx(S,{severity:"error",children:k})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 mt-4",children:[e.jsx(u,{variant:"outline",onClick:()=>{M(!1),w({})},disabled:L,children:"Cancel"}),e.jsx(u,{variant:"primary",onClick:De,disabled:L,children:L?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-4 h-4 animate-spin mr-2"}),"Reprocessing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Start Bulk Reprocess"]})})]})]})]})}export{dt as default};
