import{j as e,r as o,B as v,C as V}from"./index-D8mN3p1X.js";import{a as c}from"./adminAPI-DOOjf8NK.js";import{C as k}from"./Container-92ghf_aJ.js";import{c as F,T as y,P as q,I as j}from"./Typography-CfT4MDDf.js";import{B as w}from"./Button-CJo_el1a.js";import{A as H}from"./Add-CJyG3MMC.js";import{A as M}from"./Alert-B-smGFDq.js";import{a as N,b as G,c as J,d as B,T as s,e as K,E as Q,D as X,f as Y,S as Z,g as $}from"./Edit--b781DBI.js";import{S as z}from"./Stack-BUiep6nA.js";import{C as ee,D as te,a as re}from"./DialogContent-BNhf8-jU.js";import{T as g}from"./TextField-B__SUnjm.js";import{F as ae}from"./FormControlLabel-BqmKC8NE.js";import"./api-Bu1cG_4Q.js";import"./Menu-IZ2QR1Rp.js";const ie=F(e.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z"})),se=F(e.jsx("path",{d:"m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z"}));function ve(){const[l,W]=o.useState([]),[E,_]=o.useState(!0),[b,d]=o.useState(null),[O,S]=o.useState(!1),[u,f]=o.useState(null),[r,n]=o.useState({title:"",description:"",image_url:"",order:0,is_active:!0});o.useEffect(()=>{x()},[]);const x=async()=>{var t,a;try{_(!0),d(null);const i=await c.getBanners();W(i)}catch(i){d(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.detail)||"Failed to load banners")}finally{_(!1)}},D=t=>{t?(f(t),n({title:t.title,description:t.description||"",image_url:t.image_url||"",order:t.order,is_active:t.is_active})):(f(null),n({title:"",description:"",image_url:"",order:l.length,is_active:!0})),S(!0)},C=()=>{S(!1),f(null),n({title:"",description:"",image_url:"",order:0,is_active:!0})},L=async()=>{var t,a;try{u?await c.updateBanner(u.id,r):await c.createBanner(r),C(),x()}catch(i){d(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.detail)||"Failed to save banner")}},P=async t=>{var a,i;if(window.confirm("Are you sure you want to delete this banner?"))try{await c.deleteBanner(t),x()}catch(m){d(((i=(a=m.response)==null?void 0:a.data)==null?void 0:i.detail)||"Failed to delete banner")}},A=async(t,a)=>{var T,I;const i=l.find(h=>h.id===t);if(!i)return;const m=l.findIndex(h=>h.id===t),p=a==="up"?m-1:m+1;if(p<0||p>=l.length)return;const R=l[p].order,U=i.order;try{await c.updateBanner(t,{order:R}),await c.updateBanner(l[p].id,{order:U}),x()}catch(h){d(((I=(T=h.response)==null?void 0:T.data)==null?void 0:I.detail)||"Failed to update order")}};return E?e.jsx(k,{maxWidth:"xl",children:e.jsx(v,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(V,{})})}):e.jsxs(k,{maxWidth:"xl",children:[e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[e.jsx(y,{variant:"h4",component:"h1",fontWeight:"bold",children:"Banner Management"}),e.jsx(w,{variant:"contained",startIcon:e.jsx(H,{}),onClick:()=>D(),children:"Add Banner"})]}),b&&e.jsx(M,{severity:"error",sx:{mb:2},onClose:()=>d(null),children:b}),e.jsx(N,{component:q,children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsxs(B,{children:[e.jsx(s,{children:"Order"}),e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Image"}),e.jsx(s,{children:"Status"}),e.jsx(s,{align:"right",children:"Actions"})]})}),e.jsxs(K,{children:[l.map((t,a)=>e.jsxs(B,{hover:!0,children:[e.jsx(s,{children:e.jsxs(z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(j,{size:"small",onClick:()=>A(t.id,"up"),disabled:a===0,children:e.jsx(se,{fontSize:"small"})}),e.jsx(y,{variant:"body2",children:t.order}),e.jsx(j,{size:"small",onClick:()=>A(t.id,"down"),disabled:a===l.length-1,children:e.jsx(ie,{fontSize:"small"})})]})}),e.jsx(s,{children:t.title}),e.jsx(s,{children:t.image_url?e.jsx(v,{component:"img",src:t.image_url,alt:t.title,sx:{width:60,height:40,objectFit:"cover",borderRadius:1}}):"-"}),e.jsx(s,{children:e.jsx(ee,{label:t.is_active?"Active":"Inactive",color:t.is_active?"success":"default",size:"small"})}),e.jsxs(s,{align:"right",children:[e.jsx(j,{size:"small",onClick:()=>D(t),color:"primary",children:e.jsx(Q,{})}),e.jsx(j,{size:"small",onClick:()=>P(t.id),color:"error",children:e.jsx(X,{})})]})]},t.id)),l.length===0&&e.jsx(B,{children:e.jsx(s,{colSpan:5,align:"center",children:e.jsx(y,{variant:"body2",color:"text.secondary",sx:{py:4},children:"No banners found. Create your first banner to get started."})})})]})]})}),e.jsxs(te,{open:O,onClose:C,maxWidth:"md",fullWidth:!0,children:[e.jsx(Y,{children:u?"Edit Banner":"Create Banner"}),e.jsx(re,{children:e.jsxs(z,{spacing:3,sx:{mt:1},children:[e.jsx(g,{label:"Title",fullWidth:!0,required:!0,value:r.title,onChange:t=>n({...r,title:t.target.value})}),e.jsx(g,{label:"Description",fullWidth:!0,multiline:!0,rows:4,value:r.description,onChange:t=>n({...r,description:t.target.value})}),e.jsx(g,{label:"Image URL",fullWidth:!0,value:r.image_url,onChange:t=>n({...r,image_url:t.target.value}),placeholder:"https://example.com/image.jpg"}),e.jsx(g,{label:"Order",type:"number",fullWidth:!0,value:r.order,onChange:t=>n({...r,order:parseInt(t.target.value)||0})}),e.jsx(ae,{control:e.jsx(Z,{checked:r.is_active,onChange:t=>n({...r,is_active:t.target.checked})}),label:"Active"})]})}),e.jsxs($,{children:[e.jsx(w,{onClick:C,children:"Cancel"}),e.jsx(w,{onClick:L,variant:"contained",disabled:!r.title,children:u?"Update":"Create"})]})]})]})}export{ve as default};
