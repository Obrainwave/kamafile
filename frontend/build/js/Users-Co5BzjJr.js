import{j as e,a as me,g as ge,r as p,b as be,o as Te,s as _,c as q,e as je,w as ne,m as J,B as z,C as Ie}from"./index-D8mN3p1X.js";import{a as se}from"./adminAPI-DOOjf8NK.js";import{C as Ce}from"./Container-92ghf_aJ.js";import{c as V,I as W,u as D,T as le,P as ie}from"./Typography-CfT4MDDf.js";import{A as Me}from"./Alert-B-smGFDq.js";import{I as Re,S as oe,T as ae,a as re,b as ce}from"./TextField-B__SUnjm.js";import{S as Le}from"./Search-BRA0sHfJ.js";import{T as i,a as we,b as _e,c as ke,d as de,e as Ae,E as De,D as Ue,f as Fe,S as ue,g as Ne}from"./Edit--b781DBI.js";import{C as K,D as Ee,a as ze}from"./DialogContent-BNhf8-jU.js";import{M as b,T as $e}from"./Toolbar-sv-8sTU6.js";import{M as We}from"./Menu-IZ2QR1Rp.js";import{F as pe}from"./FormControlLabel-BqmKC8NE.js";import{B as he}from"./Button-CJo_el1a.js";import"./api-Bu1cG_4Q.js";import"./dividerClasses-B2gYjZRc.js";const He=V(e.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"})),Ve=V(e.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"})),Ge=V(e.jsx("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})),Ke=V(e.jsx("path",{d:"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"}));function qe(a){return me("MuiTablePaginationActions",a)}ge("MuiTablePaginationActions",["root"]);const Je=a=>{const{classes:n}=a;return je({root:["root"]},qe,n)},Qe=_("div",{name:"MuiTablePaginationActions",slot:"Root"})({}),Xe=p.forwardRef(function(n,S){const R=be({props:n,name:"MuiTablePaginationActions"}),{backIconButtonProps:U,className:T,count:y,disabled:j=!1,getItemAriaLabel:o,nextIconButtonProps:F,onPageChange:L,page:r,rowsPerPage:B,showFirstButton:$,showLastButton:N,slots:x={},slotProps:s={},...f}=R,c=Te(),d=Je(R),v=C=>{L(C,0)},P=C=>{L(C,r-1)},E=C=>{L(C,r+1)},A=C=>{L(C,Math.max(0,Math.ceil(y/B)-1))},m=x.firstButton??W,u=x.lastButton??W,h=x.nextButton??W,t=x.previousButton??W,l=x.firstButtonIcon??He,g=x.lastButtonIcon??Ve,w=x.nextButtonIcon??Ke,G=x.previousButtonIcon??Ge,I=c?u:m,Q=c?h:t,X=c?t:h,Y=c?m:u,Z=c?s.lastButton:s.firstButton,O=c?s.nextButton:s.previousButton,ee=c?s.previousButton:s.nextButton,te=c?s.firstButton:s.lastButton;return e.jsxs(Qe,{ref:S,className:q(d.root,T),...f,children:[$&&e.jsx(I,{onClick:v,disabled:j||r===0,"aria-label":o("first",r),title:o("first",r),...Z,children:c?e.jsx(g,{...s.lastButtonIcon}):e.jsx(l,{...s.firstButtonIcon})}),e.jsx(Q,{onClick:P,disabled:j||r===0,color:"inherit","aria-label":o("previous",r),title:o("previous",r),...O??U,children:c?e.jsx(w,{...s.nextButtonIcon}):e.jsx(G,{...s.previousButtonIcon})}),e.jsx(X,{onClick:E,disabled:j||(y!==-1?r>=Math.ceil(y/B)-1:!1),color:"inherit","aria-label":o("next",r),title:o("next",r),...ee??F,children:c?e.jsx(G,{...s.previousButtonIcon}):e.jsx(w,{...s.nextButtonIcon})}),N&&e.jsx(Y,{onClick:A,disabled:j||r>=Math.ceil(y/B)-1,"aria-label":o("last",r),title:o("last",r),...te,children:c?e.jsx(l,{...s.firstButtonIcon}):e.jsx(g,{...s.lastButtonIcon})})]})});function Ye(a){return me("MuiTablePagination",a)}const H=ge("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]);var xe;const Ze=_(i,{name:"MuiTablePagination",slot:"Root"})(J(({theme:a})=>({overflow:"auto",color:(a.vars||a).palette.text.primary,fontSize:a.typography.pxToRem(14),"&:last-child":{padding:0}}))),Oe=_($e,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(a,n)=>({[`& .${H.actions}`]:n.actions,...n.toolbar})})(J(({theme:a})=>({minHeight:52,paddingRight:2,[`${a.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[a.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${H.actions}`]:{flexShrink:0,marginLeft:20}}))),et=_("div",{name:"MuiTablePagination",slot:"Spacer"})({flex:"1 1 100%"}),tt=_("p",{name:"MuiTablePagination",slot:"SelectLabel"})(J(({theme:a})=>({...a.typography.body2,flexShrink:0}))),st=_(oe,{name:"MuiTablePagination",slot:"Select",overridesResolver:(a,n)=>({[`& .${H.selectIcon}`]:n.selectIcon,[`& .${H.select}`]:n.select,...n.input,...n.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${H.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),at=_(b,{name:"MuiTablePagination",slot:"MenuItem"})({}),ot=_("p",{name:"MuiTablePagination",slot:"DisplayedRows"})(J(({theme:a})=>({...a.typography.body2,flexShrink:0})));function nt({from:a,to:n,count:S}){return`${a}â€“${n} of ${S!==-1?S:`more than ${n}`}`}function lt(a){return`Go to ${a} page`}const it=a=>{const{classes:n}=a;return je({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},Ye,n)},rt=p.forwardRef(function(n,S){const R=be({props:n,name:"MuiTablePagination"}),{ActionsComponent:U=Xe,backIconButtonProps:T,colSpan:y,component:j=i,count:o,disabled:F=!1,getItemAriaLabel:L=lt,labelDisplayedRows:r=nt,labelRowsPerPage:B="Rows per page:",nextIconButtonProps:$,onPageChange:N,onRowsPerPageChange:x,page:s,rowsPerPage:f,rowsPerPageOptions:c=[10,25,50,100],SelectProps:k={},showFirstButton:d=!1,showLastButton:v=!1,slotProps:P={},slots:E={},...A}=R,m=R,u=it(m),h=(P==null?void 0:P.select)??k,t=h.native?"option":at;let l;(j===i||j==="td")&&(l=y||1e3);const g=ne(h.id),w=ne(h.labelId),G=()=>o===-1?(s+1)*f:f===-1?o:Math.min(o,(s+1)*f),I={slots:E,slotProps:P},[Q,X]=D("root",{ref:S,className:u.root,elementType:Ze,externalForwardedProps:{...I,component:j,...A},ownerState:m,additionalProps:{colSpan:l}}),[Y,Z]=D("toolbar",{className:u.toolbar,elementType:Oe,externalForwardedProps:I,ownerState:m}),[O,ee]=D("spacer",{className:u.spacer,elementType:et,externalForwardedProps:I,ownerState:m}),[te,C]=D("selectLabel",{className:u.selectLabel,elementType:tt,externalForwardedProps:I,ownerState:m,additionalProps:{id:w}}),[fe,ve]=D("select",{className:u.select,elementType:st,externalForwardedProps:I,ownerState:m}),[Pe,Se]=D("menuItem",{className:u.menuItem,elementType:t,externalForwardedProps:I,ownerState:m}),[ye,Be]=D("displayedRows",{className:u.displayedRows,elementType:ot,externalForwardedProps:I,ownerState:m});return e.jsx(Q,{...X,children:e.jsxs(Y,{...Z,children:[e.jsx(O,{...ee}),c.length>1&&e.jsx(te,{...C,children:B}),c.length>1&&e.jsx(fe,{variant:"standard",...!h.variant&&{input:xe||(xe=e.jsx(Re,{}))},value:f,onChange:x,id:g,labelId:w,...h,classes:{...h.classes,root:q(u.input,u.selectRoot,(h.classes||{}).root),select:q(u.select,(h.classes||{}).select),icon:q(u.selectIcon,(h.classes||{}).icon)},disabled:F,...ve,children:c.map(M=>p.createElement(Pe,{...Se,key:M.label?M.label:M,value:M.value?M.value:M},M.label?M.label:M))}),e.jsx(ye,{...Be,children:r({from:o===0?0:s*f+1,to:G(),count:o===-1?-1:o,page:s})}),e.jsx(U,{className:u.actions,backIconButtonProps:T,count:o,nextIconButtonProps:$,onPageChange:N,page:s,rowsPerPage:f,showFirstButton:d,showLastButton:v,slotProps:P.actions,slots:E.actions,getItemAriaLabel:L,disabled:F})]})})}),ct=V(e.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}));function Tt(){const[a,n]=p.useState([]),[S,R]=p.useState(!0),[U,T]=p.useState(null),[y,j]=p.useState(0),[o,F]=p.useState(25),[L,r]=p.useState(0),[B,$]=p.useState(""),[N,x]=p.useState(null),[s,f]=p.useState(null),[c,k]=p.useState(!1),[d,v]=p.useState({});p.useEffect(()=>{P()},[y,o,B]);const P=async()=>{var t,l;try{R(!0),T(null);const g={skip:y*o,limit:o};B&&(g.search=B);const w=await se.getUsers(g);n(w),r(w.length)}catch(g){T(((l=(t=g.response)==null?void 0:t.data)==null?void 0:l.detail)||"Failed to load users")}finally{R(!1)}},E=(t,l)=>{x(t.currentTarget),f(l)},A=()=>{x(null),f(null)},m=()=>{s&&(v({full_name:s.full_name,phone_number:s.phone_number,user_type:s.user_type,is_active:s.is_active,is_verified:s.is_verified,role:s.role}),k(!0)),A()},u=async()=>{var t,l;if(s)try{await se.updateUser(s.id,d),k(!1),P()}catch(g){T(((l=(t=g.response)==null?void 0:t.data)==null?void 0:l.detail)||"Failed to update user")}},h=async()=>{var t,l;if(s)try{await se.deleteUser(s.id),A(),P()}catch(g){T(((l=(t=g.response)==null?void 0:t.data)==null?void 0:l.detail)||"Failed to delete user")}};return e.jsxs(Ce,{maxWidth:"xl",children:[e.jsx(z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsxs(z,{children:[e.jsx(le,{variant:"h4",component:"h1",fontWeight:"bold",children:"User Management"}),e.jsx(le,{variant:"body2",color:"text.secondary",children:"Manage users and their permissions"})]})}),U&&e.jsx(Me,{severity:"error",sx:{mb:2},onClose:()=>T(null),children:U}),e.jsx(ie,{sx:{p:2,mb:2},children:e.jsx(z,{sx:{display:"flex",gap:2},children:e.jsx(ae,{fullWidth:!0,placeholder:"Search users by name, email, or phone...",value:B,onChange:t=>$(t.target.value),InputProps:{startAdornment:e.jsx(Le,{sx:{mr:1,color:"text.secondary"}})}})})}),e.jsx(we,{component:ie,children:S?e.jsx(z,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(Ie,{})}):e.jsxs(e.Fragment,{children:[e.jsxs(_e,{children:[e.jsx(ke,{children:e.jsxs(de,{children:[e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Email"}),e.jsx(i,{children:"Phone"}),e.jsx(i,{children:"Type"}),e.jsx(i,{children:"Role"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Created"}),e.jsx(i,{align:"right",children:"Actions"})]})}),e.jsx(Ae,{children:a.map(t=>e.jsxs(de,{hover:!0,children:[e.jsx(i,{children:t.full_name}),e.jsx(i,{children:t.email}),e.jsx(i,{children:t.phone_number||"-"}),e.jsx(i,{children:e.jsx(K,{label:t.user_type,size:"small",variant:"outlined"})}),e.jsx(i,{children:e.jsx(K,{label:t.role||"user",size:"small",color:t.role==="admin"||t.role==="super_admin"?"primary":"default"})}),e.jsx(i,{children:e.jsxs(z,{sx:{display:"flex",gap:1},children:[e.jsx(K,{label:t.is_active?"Active":"Inactive",size:"small",color:t.is_active?"success":"default"}),t.is_verified&&e.jsx(K,{label:"Verified",size:"small",color:"info"})]})}),e.jsx(i,{children:new Date(t.created_at).toLocaleDateString()}),e.jsx(i,{align:"right",children:e.jsx(W,{size:"small",onClick:l=>E(l,t),children:e.jsx(ct,{})})})]},t.id))})]}),e.jsx(rt,{component:"div",count:L,page:y,onPageChange:(t,l)=>j(l),rowsPerPage:o,onRowsPerPageChange:t=>{F(parseInt(t.target.value,10)),j(0)}})]})}),e.jsxs(We,{anchorEl:N,open:!!N,onClose:A,children:[e.jsxs(b,{onClick:m,children:[e.jsx(De,{sx:{mr:1}}),"Edit"]}),e.jsxs(b,{onClick:h,children:[e.jsx(Ue,{sx:{mr:1}}),"Delete"]})]}),e.jsxs(Ee,{open:c,onClose:()=>k(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Fe,{children:"Edit User"}),e.jsx(ze,{children:e.jsxs(z,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsx(ae,{label:"Full Name",fullWidth:!0,value:d.full_name||"",onChange:t=>v({...d,full_name:t.target.value})}),e.jsx(ae,{label:"Phone Number",fullWidth:!0,value:d.phone_number||"",onChange:t=>v({...d,phone_number:t.target.value})}),e.jsxs(re,{fullWidth:!0,children:[e.jsx(ce,{children:"User Type"}),e.jsxs(oe,{value:d.user_type||"",label:"User Type",onChange:t=>v({...d,user_type:t.target.value}),children:[e.jsx(b,{value:"individual",children:"Individual"}),e.jsx(b,{value:"freelancer",children:"Freelancer"}),e.jsx(b,{value:"micro_business",children:"Micro Business"}),e.jsx(b,{value:"sme",children:"SME"})]})]}),e.jsxs(re,{fullWidth:!0,children:[e.jsx(ce,{children:"Role"}),e.jsxs(oe,{value:d.role||"user",label:"Role",onChange:t=>v({...d,role:t.target.value}),children:[e.jsx(b,{value:"user",children:"User"}),e.jsx(b,{value:"support",children:"Support"}),e.jsx(b,{value:"moderator",children:"Moderator"}),e.jsx(b,{value:"admin",children:"Admin"}),e.jsx(b,{value:"super_admin",children:"Super Admin"})]})]}),e.jsx(pe,{control:e.jsx(ue,{checked:d.is_active??!0,onChange:t=>v({...d,is_active:t.target.checked})}),label:"Active"}),e.jsx(pe,{control:e.jsx(ue,{checked:d.is_verified??!1,onChange:t=>v({...d,is_verified:t.target.checked})}),label:"Verified"})]})}),e.jsxs(Ne,{children:[e.jsx(he,{onClick:()=>k(!1),children:"Cancel"}),e.jsx(he,{onClick:u,variant:"contained",children:"Save"})]})]})]})}export{Tt as default};
