import{u as S,r as d,j as e,L as f}from"./react-vendor-CJSarQ9f.js";import{H as C}from"./Header-CkcGtpBv.js";import{a as I}from"./api-DT-DgYzl.js";import{B as s,v as k,F as A,G as D,U as P,d as o,_ as W,m as E,k as g,$ as z,I as B,a0 as F,a1 as L,i as H,a as N}from"./mui-vendor-CUsFfAzq.js";import"./vendor-Bo3UNITv.js";import"./utils-vendor-D5lHaTRS.js";function V(){const y=S(),[c,j]=d.useState(!1),[x,m]=d.useState(!1),[a,b]=d.useState({email:"",password:""}),[u,n]=d.useState(""),p=i=>{b({...a,[i.target.name]:i.target.value}),n("")},v=async i=>{var h;if(i.preventDefault(),n(""),m(!0),!a.email||!a.password){n("Please fill in all fields"),m(!1);return}try{const r=await I.login({email:a.email,password:a.password});localStorage.setItem("access_token",r.access_token),localStorage.setItem("user",JSON.stringify(r.user)),window.dispatchEvent(new CustomEvent("auth-change")),y("/")}catch(r){let l="An error occurred. Please try again.";if((h=r.response)!=null&&h.data){const t=r.response.data;Array.isArray(t.detail)?l=t.detail.map(w=>w.msg).join(", "):typeof t.detail=="string"?l=t.detail:t.detail&&typeof t.detail=="object"&&(l=t.detail.msg||t.detail.message||JSON.stringify(t.detail))}n(l)}finally{m(!1)}};return e.jsxs(s,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",bgcolor:"background.default"},children:[e.jsx(C,{}),e.jsx(s,{sx:{flex:1,display:"flex",alignItems:"center",py:4},children:e.jsx(k,{maxWidth:"sm",children:e.jsx(A,{elevation:3,children:e.jsxs(D,{sx:{p:4},children:[e.jsxs(s,{sx:{textAlign:"center",mb:4},children:[e.jsx(s,{sx:{width:64,height:64,borderRadius:"50%",bgcolor:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:e.jsx(P,{sx:{fontSize:32,color:"white"}})}),e.jsx(o,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:700},children:"Sign In"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Welcome back to Kamafile"})]}),u&&e.jsx(W,{severity:"error",sx:{mb:3},children:u}),e.jsx(s,{component:"form",onSubmit:v,children:e.jsxs(E,{spacing:3,children:[e.jsx(g,{fullWidth:!0,label:"Email address",name:"email",type:"email",value:a.email,onChange:p,required:!0,autoComplete:"email",autoFocus:!0}),e.jsx(g,{fullWidth:!0,label:"Password",name:"password",type:c?"text":"password",value:a.password,onChange:p,required:!0,autoComplete:"current-password",InputProps:{endAdornment:e.jsx(z,{position:"end",children:e.jsx(B,{onClick:()=>j(!c),edge:"end",children:c?e.jsx(F,{}):e.jsx(L,{})})})}}),e.jsx(s,{sx:{display:"flex",justifyContent:"flex-end"},children:e.jsx(f,{to:"/forgot-password",style:{textDecoration:"none",color:"inherit",fontSize:"0.875rem"},children:e.jsx(o,{variant:"body2",color:"primary",sx:{"&:hover":{textDecoration:"underline"}},children:"Forgot password?"})})}),e.jsx(H,{type:"submit",fullWidth:!0,variant:"contained",size:"large",disabled:x,sx:{bgcolor:"primary.main",py:1.5,fontSize:"1rem","&:hover":{bgcolor:"primary.dark"}},children:x?e.jsx(N,{size:24,color:"inherit"}):"Sign In"}),e.jsx(s,{sx:{textAlign:"center",mt:2},children:e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Don't have an account?"," ",e.jsx(f,{to:"/signup",style:{textDecoration:"none",color:"inherit"},children:e.jsx(o,{component:"span",variant:"body2",color:"primary",sx:{fontWeight:600,"&:hover":{textDecoration:"underline"}},children:"Sign up"})})]})})]})})]})})})})]})}export{V as default};
