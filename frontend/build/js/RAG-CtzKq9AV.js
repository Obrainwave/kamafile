import{r as c,j as e,S as k}from"./index-DxCgcyXh.js";import{a as y}from"./adminAPI-pCiTY4we.js";import{C as xe,a as ue}from"./Container-D9tpSCKj.js";import{A as q,C as ze}from"./Alert-BVCwHu8U.js";import{B as u}from"./Button-DP5zKp_w.js";import{M as P}from"./Modal-jLw6kHFP.js";import{I as O}from"./Input-oAjqnN_f.js";import{c as m}from"./createLucideIcon-Dr0X7DXv.js";import{F as Le}from"./file-text-2LYJsnPP.js";import{T as $e}from"./trash-2-DMBNHSRv.js";import{C as qe}from"./circle-check-big-9x3cbfmd.js";import"./api-sa1Artjr.js";import"./x-CZXEUpxe.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Oe=m("check",Pe);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ve=m("copy",Be);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Ge=m("database",Ee);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],We=m("external-link",Ie);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Xe=m("globe",He);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Qe=m("link",Ke);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],S=m("loader",Je);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],B=m("refresh-cw",Ye);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],me=m("upload",Ze);function ut(){var Q,J,Y,Z,ee,te,se,ae;const[z,he]=c.useState([]),[fe,V]=c.useState(!0),[C,d]=c.useState(null),[n,E]=c.useState(null),[D,G]=c.useState(!0),[b,I]=c.useState(!1),[ge,R]=c.useState(!1),[ye,T]=c.useState(!1),[A,F]=c.useState(!1),[o,j]=c.useState({title:"",file:null}),[x,N]=c.useState({title:"",url:""}),[je,v]=c.useState(!1),[ve,M]=c.useState(null),[_e,U]=c.useState(!1),[L,W]=c.useState(!1),[h,w]=c.useState({}),f=c.useRef(null);c.useEffect(()=>{g(),H(!0);const t=setInterval(()=>{g(),H(!1)},5e3);return()=>clearInterval(t)},[]);const H=async(t=!1)=>{var s,l,r,i,p,_,le,ne,re,ie;try{t?G(!0):I(!0);const a=await y.getVectorStoreInfo(),Se={qdrant_host:(a==null?void 0:a.qdrant_host)||"localhost",qdrant_port:(a==null?void 0:a.qdrant_port)||6333,web_ui_url:(a==null?void 0:a.web_ui_url)||"http://localhost:6333/dashboard",collection_info:{name:((s=a==null?void 0:a.collection_info)==null?void 0:s.name)||"tax_legal_documents",points_count:typeof((l=a==null?void 0:a.collection_info)==null?void 0:l.points_count)=="number"?a.collection_info.points_count:typeof((r=a==null?void 0:a.collection_info)==null?void 0:r.vectors_count)=="number"?a.collection_info.vectors_count:0,vectors_count:typeof((i=a==null?void 0:a.collection_info)==null?void 0:i.vectors_count)=="number"?a.collection_info.vectors_count:typeof((p=a==null?void 0:a.collection_info)==null?void 0:p.points_count)=="number"?a.collection_info.points_count:0,indexed_vectors_count:(()=>{var oe,de,pe;const $=typeof((oe=a==null?void 0:a.collection_info)==null?void 0:oe.points_count)=="number"?a.collection_info.points_count:typeof((de=a==null?void 0:a.collection_info)==null?void 0:de.vectors_count)=="number"?a.collection_info.vectors_count:0,ce=typeof((pe=a==null?void 0:a.collection_info)==null?void 0:pe.indexed_vectors_count)=="number"?a.collection_info.indexed_vectors_count:null;return ce===0&&$>0?$:ce??$})(),status:((_=a==null?void 0:a.collection_info)==null?void 0:_.status)||"unknown",config:{vector_size:typeof((ne=(le=a==null?void 0:a.collection_info)==null?void 0:le.config)==null?void 0:ne.vector_size)=="number"?a.collection_info.config.vector_size:384,distance:((ie=(re=a==null?void 0:a.collection_info)==null?void 0:re.config)==null?void 0:ie.distance)||"Cosine"}}};E(Se)}catch{(!n||t)&&E({qdrant_host:"localhost",qdrant_port:6333,web_ui_url:"http://localhost:6333/dashboard",collection_info:{name:"tax_legal_documents",points_count:0,vectors_count:0,indexed_vectors_count:0,status:"error",config:{vector_size:384,distance:"Cosine"}}})}finally{G(!1),setTimeout(()=>I(!1),200)}},g=async()=>{var t,s;try{V(!0),d(null);const l=await y.getRAGDocuments();he(l)}catch(l){d(((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.detail)||"Failed to load RAG documents")}finally{V(!1)}},X=t=>{if(!t)return"";let s=t.replace(/\.[^/.]+$/,"");return s=s.replace(/[-_]/g," "),s=s.replace(/\s+base\s*$/i,""),s=s.replace(/\s+copy\s*$/i,""),s=s.replace(/\s+\(\d+\)\s*$/,""),s=s.replace(/\b(19|20)\d{2}\b/g,""),s=s.replace(/\s+/g," ").trim(),s.split(" ").map(i=>i===i.toUpperCase()&&i.length>=2&&i.length<=4?i:i.charAt(0).toUpperCase()+i.slice(1).toLowerCase()).join(" ")||t.replace(/\.[^/.]+$/,"")},be=t=>{var l,r;const s=(l=t.target.files)==null?void 0:l[0];if(s){const i=X(s.name),p=o.title,_=!p||p===((r=o.file)==null?void 0:r.name)?i:p;j({...o,file:s,title:_})}},Ne=t=>{t.preventDefault(),t.stopPropagation(),v(!0)},we=t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget.contains(t.relatedTarget)||v(!1)},ke=t=>{var l;t.preventDefault(),t.stopPropagation(),v(!1);const s=t.dataTransfer.files;if(s&&s.length>0){const r=s[0],i=X(r.name),p=o.title,_=!p||p===((l=o.file)==null?void 0:l.name)?i:p;j({...o,file:r,title:_})}},Ce=async()=>{var t,s,l,r;if(!o.file||!o.title){d("Please select a file and provide a title");return}try{F(!0),d(null),await y.uploadRAGFile(o.file,o.title),R(!1),j({title:"",file:null}),v(!1),f.current&&(f.current.value=""),g()}catch(i){const p=((s=(t=i.response)==null?void 0:t.data)==null?void 0:s.detail)||((r=(l=i.response)==null?void 0:l.data)==null?void 0:r.message)||i.message||"Failed to upload file";d(`Upload failed: ${p}`)}finally{F(!1)}},De=async()=>{var t,s;if(!x.url||!x.title){d("Please provide both URL and title");return}try{F(!0),d(null),await y.addRAGUrl({title:x.title,url:x.url}),T(!1),N({title:"",url:""}),g()}catch(l){d(((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.detail)||"Failed to add URL")}finally{F(!1)}},Re=async t=>{var s,l;if(window.confirm("Are you sure you want to delete this document?"))try{await y.deleteRAGDocument(t),g()}catch(r){d(((l=(s=r.response)==null?void 0:s.data)==null?void 0:l.detail)||"Failed to delete document")}},Te=async t=>{var s,l;try{await y.reprocessRAGDocument(t),g()}catch(r){d(((l=(s=r.response)==null?void 0:s.data)==null?void 0:l.detail)||"Failed to reprocess document")}},Ae=async()=>{var t,s;if(window.confirm(`This will reprocess ${h.status?`all ${h.status} `:"all "}documents. Old chunks will be deleted and documents will be re-indexed with updated metadata (law names, etc.). This may take several minutes. Continue?`))try{W(!0),d(null);const l=await y.bulkReprocessRAGDocuments(h.status,h.sourceType),r=`${l.message}. `+(l.errors.length>0?`Errors: ${l.errors.length}`:"All documents queued successfully.");alert(r),U(!1),w({}),g()}catch(l){d(((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.detail)||"Failed to bulk reprocess documents")}finally{W(!1)}},Fe=async(t,s)=>{try{await navigator.clipboard.writeText(t),M(s),setTimeout(()=>{M(null)},2e3)}catch{const r=document.createElement("textarea");r.value=t,r.style.position="fixed",r.style.opacity="0",document.body.appendChild(r),r.select();try{document.execCommand("copy"),M(s),setTimeout(()=>{M(null)},2e3)}catch{}document.body.removeChild(r)}},Me=t=>{switch(t){case"completed":return e.jsx(qe,{className:"w-5 h-5 text-green-600"});case"failed":return e.jsx(ze,{className:"w-5 h-5 text-red-600"});case"processing":return e.jsx(S,{className:"w-5 h-5 text-blue-600 animate-spin"});default:return e.jsx(S,{className:"w-5 h-5 text-gray-400"})}},Ue=t=>{switch(t){case"completed":return"Completed";case"failed":return"Failed";case"processing":return"Processing";default:return"Pending"}},K=t=>t?t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(2)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`:"-";return fe&&z.length===0?e.jsx(xe,{maxWidth:"xl",children:e.jsx("div",{className:"flex justify-center p-8",children:e.jsx(k,{size:"lg"})})}):e.jsxs(xe,{maxWidth:"xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-2xl sm:text-4xl font-bold truncate",children:"RAG Management"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage documents and URLs for the knowledge base"})]}),e.jsxs("div",{className:"flex gap-3 flex-shrink-0 flex-wrap",children:[e.jsxs(u,{variant:"outline",onClick:()=>U(!0),className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(B,{className:"w-4 h-4"}),"Bulk Reprocess"]}),e.jsxs(u,{variant:"outline",onClick:()=>T(!0),className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Add URL"]}),e.jsxs(u,{variant:"primary",onClick:()=>R(!0),className:"flex items-center gap-2 whitespace-nowrap",children:[e.jsx(me,{className:"w-4 h-4"}),"Upload File"]})]})]}),C&&e.jsx(q,{severity:"error",className:"mb-4",onClose:()=>d(null),children:C}),e.jsxs(ue,{className:"mb-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ge,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Vector Database Statistics"}),b&&e.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500 animate-pulse",children:[e.jsx(S,{className:"w-3 h-3 animate-spin"}),e.jsx("span",{children:"Updating..."})]})]}),(n==null?void 0:n.web_ui_url)&&e.jsxs("a",{href:n.web_ui_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-primary hover:underline",children:[e.jsx(We,{className:"w-4 h-4"}),"Open Qdrant Web UI"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 min-h-[100px] flex flex-col justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Chunks"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 h-8 flex items-center transition-opacity duration-200",children:D?e.jsx(k,{size:"sm"}):e.jsx("span",{className:b?"opacity-70":"opacity-100",children:String(((Q=n==null?void 0:n.collection_info)==null?void 0:Q.points_count)??((J=n==null?void 0:n.collection_info)==null?void 0:J.vectors_count)??0)})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 min-h-[100px] flex flex-col justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Indexed Vectors"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 h-8 flex items-center transition-opacity duration-200",children:D?e.jsx(k,{size:"sm"}):e.jsx("span",{className:b?"opacity-70":"opacity-100",children:String(((Y=n==null?void 0:n.collection_info)==null?void 0:Y.indexed_vectors_count)??0)})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 min-h-[100px] flex flex-col justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Vector Size"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 h-8 flex items-center transition-opacity duration-200",children:D?e.jsx(k,{size:"sm"}):e.jsx("span",{className:b?"opacity-70":"opacity-100",children:(ee=(Z=n==null?void 0:n.collection_info)==null?void 0:Z.config)!=null&&ee.vector_size?`${n.collection_info.config.vector_size}D`:"384D"})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 min-h-[100px] flex flex-col justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Distance Metric"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 h-8 flex items-center transition-opacity duration-200",children:D?e.jsx(k,{size:"sm"}):e.jsx("span",{className:b?"opacity-70":"opacity-100",children:((se=(te=n==null?void 0:n.collection_info)==null?void 0:te.config)==null?void 0:se.distance)||"Cosine"})})]})]}),((ae=n==null?void 0:n.collection_info)==null?void 0:ae.name)&&e.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[e.jsx("strong",{children:"Collection:"})," ",n.collection_info.name," â€¢"," ",e.jsx("strong",{children:"Host:"})," ",n.qdrant_host,":",n.qdrant_port]})]}),e.jsx(ue,{className:"overflow-hidden w-full",children:e.jsx("div",{className:"overflow-x-auto w-full",style:{minWidth:0},children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",style:{width:"100%",tableLayout:"auto"},children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Type"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Size"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Chunks"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Created"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[z.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 sm:px-6 py-4 min-w-0 max-w-xs",children:e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.source_type==="url"?e.jsx(Xe,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}):e.jsx(Le,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:t.title})]})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-700",children:t.source_type})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 min-w-0 max-w-xs",children:e.jsx("div",{className:"text-sm text-gray-600 truncate",title:t.source_path||t.file_name||"",children:t.source_type==="url"?e.jsx("a",{href:t.source_path||"",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate block",children:t.source_path}):e.jsx("span",{className:"truncate",children:t.file_name||t.source_path||"-"})})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:K(t.file_size)}),e.jsxs("td",{className:"w-100 px-4 sm:px-6 py-4 min-w-0 max-w-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Me(t.processing_status),e.jsx("span",{className:"text-sm text-gray-700",children:Ue(t.processing_status)})]}),t.processing_error&&e.jsxs("div",{className:"flex items-center gap-1 mt-1 group",children:[e.jsxs("div",{className:"text-xs text-red-600 truncate max-w-[100px] flex-1",title:t.processing_error,children:[t.processing_error.substring(0,40),"..."]}),e.jsx("button",{onClick:l=>{l.stopPropagation(),Fe(t.processing_error||"",t.id)},className:"flex-shrink-0 p-1 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition opacity-0 group-hover:opacity-100",title:"Copy full error message",children:ve===t.id?e.jsx(Oe,{className:"w-4 h-4 text-green-600"}):e.jsx(Ve,{className:"w-4 h-4"})})]})]}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:t.processing_status==="completed"&&((s=t.content_metadata)!=null&&s.chunks_count)?e.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded bg-green-100 text-green-700",children:[t.content_metadata.chunks_count," ",t.content_metadata.chunks_count===1?"chunk":"chunks"]}):t.processing_status==="completed"?e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded bg-gray-100 text-gray-600",children:"0 chunks"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[t.processing_status==="failed"&&e.jsx("button",{onClick:()=>Te(t.id),className:"p-1 text-blue-600 hover:text-blue-700 flex-shrink-0",title:"Reprocess",children:e.jsx(B,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Re(t.id),className:"p-1 text-red-600 hover:text-red-700 flex-shrink-0",title:"Delete",children:e.jsx($e,{className:"w-5 h-5"})})]})})]},t.id)}),z.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"No documents found. Upload a file or add a URL to get started."})})]})]})})}),e.jsx(P,{open:ge,onClose:()=>{R(!1),j({title:"",file:null}),v(!1),f.current&&(f.current.value="")},title:"Upload RAG Document",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{label:"Title (Law Name)",required:!0,value:o.title,onChange:t=>j({...o,title:t.target.value}),placeholder:"e.g., Personal Income Tax Act, VAT Act 2023",helperText:"Enter the proper law name (e.g., 'Personal Income Tax Act', not the filename). The filename will be used as a fallback if not specified."}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["File ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:`mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed rounded-lg transition cursor-pointer ${je?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragOver:Ne,onDragLeave:we,onDrop:ke,onClick:t=>{var s;t.preventDefault(),t.stopPropagation(),(s=f.current)==null||s.click()},onMouseDown:t=>t.stopPropagation(),children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(me,{className:"mx-auto h-12 w-12 text-gray-400 pointer-events-none"}),e.jsxs("div",{className:"flex text-sm text-gray-600 justify-center",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-primary hover:text-primary-dark focus-within:outline-none",onClick:t=>{t.stopPropagation(),t.preventDefault()},children:[e.jsx("span",{children:"Upload a file"}),e.jsx("input",{id:"file-upload",ref:f,name:"file-upload",type:"file",className:"sr-only",onChange:be,accept:"*/*",onClick:t=>t.stopPropagation()})]}),e.jsx("p",{className:"pl-1 pointer-events-none",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500 pointer-events-none",children:"All file types supported (PDF, DOCX, images, etc.)"}),o.file&&e.jsxs("p",{className:"text-sm text-gray-700 mt-2 pointer-events-none",children:["Selected: ",e.jsx("span",{className:"font-medium",children:o.file.name})," (",K(o.file.size),")"]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(u,{variant:"outline",onClick:()=>{R(!1),j({title:"",file:null}),v(!1),f.current&&(f.current.value="")},children:"Cancel"}),e.jsx(u,{variant:"primary",onClick:Ce,disabled:!o.file||!o.title||A,children:A?"Uploading...":"Upload"})]})]})}),e.jsx(P,{open:ye,onClose:()=>{T(!1),N({title:"",url:""})},title:"Add URL to RAG",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{label:"Title",required:!0,value:x.title,onChange:t=>N({...x,title:t.target.value}),placeholder:"Enter document title"}),e.jsx(O,{label:"URL",required:!0,type:"url",value:x.url,onChange:t=>N({...x,url:t.target.value}),placeholder:"https://example.com/page"}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx(u,{variant:"outline",onClick:()=>{T(!1),N({title:"",url:""})},children:"Cancel"}),e.jsx(u,{variant:"primary",onClick:De,disabled:!x.url||!x.title||A,children:A?"Adding...":"Add URL"})]})]})}),e.jsxs(P,{open:_e,onClose:()=>{U(!1),w({})},title:"Bulk Reprocess Documents",size:"md",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(q,{severity:"warning",children:"This will reprocess selected documents to update their metadata (law names, etc.) with the new extraction logic. Old chunks will be deleted and documents will be re-indexed. This may take several minutes."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Status (Optional)"}),e.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition",value:h.status||"",onChange:t=>w({...h,status:t.target.value||void 0}),children:[e.jsx("option",{value:"",children:"All statuses"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Only reprocess documents with the selected status. Leave empty to reprocess all."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Source Type (Optional)"}),e.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition",value:h.sourceType||"",onChange:t=>w({...h,sourceType:t.target.value||void 0}),children:[e.jsx("option",{value:"",children:"All types"}),e.jsx("option",{value:"file",children:"File uploads"}),e.jsx("option",{value:"url",children:"URLs"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Only reprocess documents of the selected type. Leave empty to reprocess all."})]})]}),C&&e.jsx(q,{severity:"error",children:C})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200 mt-4",children:[e.jsx(u,{variant:"outline",onClick:()=>{U(!1),w({})},disabled:L,children:"Cancel"}),e.jsx(u,{variant:"primary",onClick:Ae,disabled:L,children:L?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-4 h-4 animate-spin mr-2"}),"Reprocessing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Start Bulk Reprocess"]})})]})]})]})}export{ut as default};
